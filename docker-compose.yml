services:
  pinger:
    build: .
    image: pinger:latest
    container_name: pinger
    environment:
      - ENABLE_METRICS=true
      - METRICS_ADDR=0.0.0.0
      - METRICS_PORT=8000
      - ENABLE_HEALTH_ENDPOINT=true
      - HEALTH_ADDR=0.0.0.0
      - HEALTH_PORT=8001
      - LOG_TRUNCATE_ON_START=true
    ports:
      - "8000:8000"  # Prometheus metrics
      - "8001:8001"  # Health endpoint
    volumes:
      - ./logs:/app/logs
      - ./traceroutes:/app/traceroutes
    restart: unless-stopped

  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    volumes:
      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
    ports:
      - "9090:9090"
    restart: unless-stopped
